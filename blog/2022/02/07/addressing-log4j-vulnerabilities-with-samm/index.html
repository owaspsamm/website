<!doctype html><html lang><head><meta charset=utf-8><meta name=robots content="all,follow"><meta name=googlebot content="index,follow,snippet,archive"><meta name=viewport content="width=device-width,initial-scale=1"><title>Addressing Log4J vulnerabilities with SAMM</title><meta name=author content><meta name=keywords content="owasp,samm,maturity,model,software"><meta name=description content="Measure and improve your organization's software security posture"><meta property="og:title" content="Addressing Log4J vulnerabilities with SAMM"><meta property="og:description" content="It’s that dreaded notification. The one that holds the threat, and later the reality, of many sleepless nights. The newest vulnerability is here and its severity is considered critical.
This Log4J vulnerability (CVE-2021-44228) has caused quite the stir, and rightfully so. It’s kept security peeps on our toes for the last few months so it was interesting to see this topic come up during our last SAMM monthly community call."><meta property="og:type" content="article"><meta property="og:url" content="https://owaspsamm.org/blog/2022/02/07/addressing-log4j-vulnerabilities-with-samm/"><meta property="og:image" content="https://owaspsamm.org/img/site-feature-image.png"><meta property="article:section" content="blog"><meta property="article:published_time" content="2022-02-07T00:00:00+02:00"><meta property="article:modified_time" content="2022-02-07T00:00:00+02:00"><meta name=generator content="Hugo 0.81.0"><link href="//fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,500,700,800" rel=stylesheet type=text/css><link rel=stylesheet href=//use.fontawesome.com/releases/v6.4.2/css/all.css><link rel=stylesheet href=//use.fontawesome.com/releases/v6.4.2/css/v4-shims.css><link rel=stylesheet href=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css integrity=sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u crossorigin=anonymous><link href=/css/animate.css rel=stylesheet><link href=/css/style.samm.css rel=stylesheet id=theme-stylesheet><link href=/css/custom.css rel=stylesheet><!--[if lt IE 9]><script src=https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js></script><script src=https://oss.maxcdn.com/respond/1.4.2/respond.min.js></script><![endif]--><link rel="shortcut icon" href=/img/favicon.ico type=image/x-icon><link rel=apple-touch-icon href=/img/apple-touch-icon.png><link href=/css/owl.carousel.css rel=stylesheet><link href=/css/owl.theme.css rel=stylesheet><link rel=alternate href=https://owaspsamm.org/index.xml type=application/rss+xml title="OWASP SAMM"><meta property="og:title" content="Addressing Log4J vulnerabilities with SAMM"><meta property="og:type" content="website"><meta property="og:url" content="/blog/2022/02/07/addressing-log4j-vulnerabilities-with-samm//"><meta property="og:image" content="/img/logo.png"><link rel=stylesheet type=text/css href=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.css></head><body><div id=all><header><div class=navbar-affixed-top data-spy=affix data-offset-top=200><div class="navbar navbar-default yamm" role=navigation id=navbar><div class=container><div class=navbar-header><a class="navbar-brand home" href=https://owaspsamm.org/><img src=https://owaspsamm.org//img/logo.png alt="Addressing Log4J vulnerabilities with SAMM logo" class="hidden-xs hidden-sm">
<img src=https://owaspsamm.org//img/logo-small.png alt="Addressing Log4J vulnerabilities with SAMM logo" class="visible-xs visible-sm">
<span class=sr-only>Addressing Log4J vulnerabilities with SAMM - go to homepage</span></a><div class=navbar-buttons><button type=button class="navbar-toggle btn-template-main" data-toggle=collapse data-target=#navigation>
<span class=sr-only>Toggle Navigation</span>
<i class="fa fa-align-justify"></i></button></div></div><div class="navbar-collapse collapse" id=navigation><ul class="nav navbar-nav navbar-right"><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>About SAMM <span class=caret></span></a><ul class=dropdown-menu><li><a href=/about/>What is SAMM</a></li><li><a href=/team/>The team</a></li></ul></li><li class=dropdown><a href=/model/>The model</a></li><li class=dropdown><a href=/resources/>Resources</a></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>Guidance <span class=caret></span></a><ul class=dropdown-menu><li><a href=/guidance/quick-start-guide/>Getting started</a></li><li><a href=/assessment/>Assessment</a></li><li><a href=/guidance/agile/>Agile</a></li><li><a href=/benchmark/>Benchmark</a></li><li><a href=/stream-guidance/>Stream guidance</a></li></ul></li><li class=dropdown><a href=# class=dropdown-toggle data-toggle=dropdown role=button aria-haspopup=true aria-expanded=false>Community <span class=caret></span></a><ul class=dropdown-menu><li><a href=/blog/>Blog</a></li><li><a href=/user-day/>User Day</a></li><li><a href=/sponsors/>Sponsors</a></li><li><a href=/samm-users/>Users</a></li><li><a href=/practitioners/>Practitioners</a></li><li><a href=/faq/>FAQ</a></li><li><a href=/contributing/>Contributing</a></li><li><a href=/contact/>Contact</a></li></ul></li></ul></div><div class="collapse clearfix" id=search><form class=navbar-form role=search><div class=input-group><input type=text class=form-control placeholder=Search>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fa fa-search"></i></button></span></div></form></div></div></div></div></header><div id=heading-breadcrumbs><div class=container><div class=row><div class=col-md-12><h1>Addressing Log4J vulnerabilities with SAMM</h1></div></div></div></div><div id=content><div class=container><div class=row><div class=col-md-9 id=blog-post><p class="text-muted text-uppercase mb-small text-right">By <a href=#>The SAMM Project Team</a> | February 7, 2022</p><div id=post-content><div class=responsive-image><img class=img-responsive src=https://owaspsamm.org//img/blog/undraw_hacker_mind_6y85.png alt="SAMM assessment"></div><p>It’s that dreaded notification. The one that holds the threat, and later the reality, of many sleepless nights. The newest vulnerability is here and its severity is considered critical.</p><p>This Log4J vulnerability (CVE-2021-44228) has caused quite the stir, and rightfully so. It’s kept security peeps on our toes for the last few months so it was interesting to see this topic come up during our last SAMM monthly community call. One participant asked the very relevant question:</p><div class="highlight-box text-center">How can SAMM help identify systems impacted by a vulnerability like Log4Shell and then take actions to remediate it?</div><p>To sum it up, we believe this is a great example of the added value of structurally implementing SAMM. It demonstrates that when the SAMM practices and activities work together you are in a better position to face problems such as this one. No single solution will be definitive. Partial implementations will result in partial solutions. Tackling this challenge from different angles and understanding its different dimensions will provide a holistic solution. That is where SAMM will make a difference.</p><p>Let’s dive into different security practices in the model and how they help with this issue.</p><h3 id=governance--strategy--metrics>Governance | Strategy & Metrics</h3><p>The implementation of <a href=/model/governance/strategy-and-metrics/>this security practice</a> has an indirect impact but it’s an overarching one. At a high level, having a strategy around appsec to structure all your activities lays the foundation for all the rest.</p><h3 id=governance--education--guidance>Governance | Education & Guidance</h3><p>Similarly to having an appsec strategy, <a href=/model/governance/education-and-guidance/>training and awareness</a> in your team provide a baseline and brings more people into the fold. This means more eyes on the lookout and more readiness to take action when needed. Have you considered having a specific info campaign on the topic?</p><h3 id=design--secure-architecture>Design | Secure Architecture</h3><p>In <a href=/model/design/secure-architecture/stream-a/>Maturity Level 2 of Stream A, Architecture Design</a>, you identify shared infrastructure or services with security functionality. For this issue, WAFs are particularly relevant. If you don’t have the means to fix the problem in legacy applications, for example, a workaround can involve blocking traffic based on pattern matching for specific Log4Shell attack patterns towards your software.
An application firewall rule can help you detect and might even block an attack, providing an extra layer of defense. A practical example is using the OWASP Core Rule Set, see the latest Log4j rules <a href=https://coreruleset.org/20211213/crs-and-log4j-log4shell-cve-2021-44228/>here</a>.</p><h3 id=design--security-requirements>Design | Security Requirements</h3><p><a href=/model/design/security-requirements/stream-b/>Stream B in this practice</a> focuses on Supplier Security, which applies quite specifically to this vulnerability. Ideally, include a clause in your SLA so suppliers must keep software up to date regarding security. Make sure your supplier contracts state they should act upon security issues, providing a time frame if possible. This includes third-party software you use or acquire, as well as subcontractors that provide services for your organization. You might even be fortunate enough to get Bills of Materials from some of your suppliers, that will allow you to analyze the problem for specific acquired softwares that you are running.</p><h3 id=implementation--secure-build>Implementation | Secure Build</h3><p><a href=/model/implementation/secure-build/stream-b/>Stream B in the secure Build practice</a> is about Software dependencies. Again, spot on for Log4Shell.
Building a BOM (Bill of Materials) for your applications is part of the quality criteria for Maturity Level 1 in this activity. What are the libraries included in the software you’re developing? You can make it specifically identify Log4J, adding automatic checks for vulnerabilities in your BOM. OWASP related projects to consider are OWASP <a href=https://owasp.org/2021/01/08/dependency-track>Dependency-Track</a> and <a href=https://binarymindset.com/owasp-dependency-check/>Dependency-Check</a>.</p><h3 id=implementation--defect-management>Implementation | Defect Management</h3><p><a href=/model/implementation/defect-management/stream-a/>Stream A</a> is where we keep track of defects. This is the place where the output of many sources of defects come together. You may have outputs from scans, threat modeling, BOM analysis. In this practice is where they all come together and where you’ll look for Log4J issues in the list of defects.</p><p>Activities in <a href=/model/implementation/defect-management/stream-b/>Stream B, Metrics and Feedback</a>, are about doing something useful with the defects that you identify . Consider defining a Log4J specific metric or trigger to monitor the state of the organization on the topic.</p><h3 id=verification--security-testing>Verification | Security Testing</h3><p>The aim <a href=/model/verification/security-testing/>here</a> is to uncover weaknesses in the organization’s applications through both automated and manual tests. Implementing this practice, we should be able to determine whether the software running in the organization is vulnerable to, in this case, Log4Shell. You can focus on breadth through application scans to identify issues, and you can use static code analysis, for example, for a more in-depth approach. A practical example is to use the <a href=https://www.zaproxy.org/blog/2021-12-14-log4shell-detection-with-zap/>OWASP ZAP Log4Shell Active Scan Rule</a>.</p><h3 id=verification--architecture-assessment>Verification | Architecture Assessment</h3><p><a href=/model/verification/architecture-assessment/stream-b/>Stream B</a> activities in the Architecture Assessment practice consist of reviewing the architecture for unmitigated threats. In this case it can involve evaluating the architecture for Log4J specific threats. Maturity Level 2 uses input from Threat Modeling and logs unhandled threats as defects.</p><h3 id=operations--incident-management>Operations | Incident Management</h3><p>The <a href=/model/operations/incident-management/>Incident Management security practice</a> is about dealing with breaches or threats of breaches through, for example, the abuse of a security vulnerability. This means aiming for a higher score here could mean our organization is better prepared for Log4J based attacks. In this practice, Stream A is about detection and Stream B is about response.</p><h3 id=operations--environment-management>Operations | Environment Management</h3><p><a href=/model/operations/environment-management/stream-b/>Stream B of Environment Management</a> helps you set up a secure environment, making sure you regularly patch your systems. In the case of Log4J this means updating libraries in your software regularly, and forcing an update now.</p><div class=responsive-image><img class=img-responsive src=https://owaspsamm.org//img/blog/security.png alt="SAMM assessment"></div><p>Log4Shell isn’t the first critical vulnerability and it certainly won’t be the last. Hopefully, we’ve shown how SAMM can help your organization be better prepared for what’s to come, understanding and improving your security posture and having the tools to react fast and efficiently.</p><p>The best way to lower the risk and get this problem under control is by looking at it in all its dimensions, implementing the different practices and activities in the Model. Doing so will help you attack the problem from multiple sides and compensate for real-world situations like having difficulties building a comprehensive BOM. There are quite a few scripts around to try and spot the vulnerability or even protection patterns to plug in to your WAF to block this kind of attack. But these are limited solutions. They are like pieces of a puzzle. And we need the combination of all the pieces to solve this in a controlled way. SAMM helps us with a structural and proactive approach instead of a reactive one.</p><p>Join us on our <a href=https://owasp.slack.com/messages/C0VF1EJGH>SAMM Slack channel</a> and let us know how you handled Log4Shell with SAMM practices!</p><p>Here are some background links for Log4Shell:</p><ul><li><a href=https://nakedsecurity.sophos.com/2021/12/13/log4shell-explained-how-it-works-why-you-need-to-know-and-how-to-fix-it/ target=_blank>A good explanation</a> <i class="link-icon fas fa-external-link-alt"></i>of Log4Shell from naked security by Sophos</li><li><a href="https://blog.sonatype.com/ftc-warning-in-wake-of-log4j?hsLang=en-us" target=_blank>Some input</a> <i class="link-icon fas fa-external-link-alt"></i>on why software composition analysis tools might be important to identify and track library usage</li><li>A <a href=https://www.reddit.com/r/blueteamsec/comments/rd38z9/log4j_0day_being_exploited/ target=_blank>list of recommendations and patching pointers</a> <i class="link-icon fas fa-external-link-alt"></i></li></ul><p><br><br>Be a part of the SAMM community!</p><ul><li>Join our Slack channel where you will meet other users, ask questions, give feedback, and be in the loop of all things SAMM.</li><li>Join our monthly community calls, where we discuss topics like Log4J, exchange experiences and ideas, and review SAMM’s security practices in depth.</li></ul></div></div><div class=col-md-3><div class="panel panel-default sidebar-menu"><div class=panel-heading><h3 class=panel-title>Search</h3></div><div class=panel-body><form action=//google.com/search method=get accept-charset=utf-8 role=search><div class=input-group><input type=search name=q class=form-control placeholder=Search>
<input type=hidden name=sitesearch value=https://owaspsamm.org/>
<span class=input-group-btn><button type=submit class="btn btn-template-main"><i class="fa fa-search"></i></button></span></div></form></div></div><div class="panel panel-default sidebar-menu"><div class=panel-heading><h3 class=panel-title>Categories</h3></div><div class=panel-body><ul class="nav nav-pills nav-stacked"><li><a href=https://owaspsamm.org/categories/assessment>assessment (5)</a></li><li><a href=https://owaspsamm.org/categories/community>community (1)</a></li><li><a href=https://owaspsamm.org/categories/events>events (1)</a></li><li><a href=https://owaspsamm.org/categories/guidance>guidance (2)</a></li><li><a href=https://owaspsamm.org/categories/mapping>mapping (3)</a></li><li><a href=https://owaspsamm.org/categories/samm-project>samm-project (6)</a></li><li><a href=https://owaspsamm.org/categories/training>training (1)</a></li></ul></div></div><div class="panel sidebar-menu"><div class=panel-heading><h3 class=panel-title>Tags</h3></div><div class=panel-body><ul class=tag-cloud><li><a href=https://owaspsamm.org/tags/assessment><i class="fa fa-tags"></i>assessment</a></li><li><a href=https://owaspsamm.org/tags/automation><i class="fa fa-tags"></i>automation</a></li><li><a href=https://owaspsamm.org/tags/beta><i class="fa fa-tags"></i>beta</a></li><li><a href=https://owaspsamm.org/tags/bsimm><i class="fa fa-tags"></i>bsimm</a></li><li><a href=https://owaspsamm.org/tags/ci/cd><i class="fa fa-tags"></i>ci/cd</a></li><li><a href=https://owaspsamm.org/tags/cicd><i class="fa fa-tags"></i>cicd</a></li><li><a href=https://owaspsamm.org/tags/governance><i class="fa fa-tags"></i>governance</a></li><li><a href=https://owaspsamm.org/tags/incident><i class="fa fa-tags"></i>incident</a></li><li><a href=https://owaspsamm.org/tags/log4j><i class="fa fa-tags"></i>log4j</a></li><li><a href=https://owaspsamm.org/tags/mapping><i class="fa fa-tags"></i>mapping</a></li><li><a href=https://owaspsamm.org/tags/maturity><i class="fa fa-tags"></i>maturity</a></li><li><a href=https://owaspsamm.org/tags/microsoft-sdl><i class="fa fa-tags"></i>microsoft-sdl</a></li><li><a href=https://owaspsamm.org/tags/model><i class="fa fa-tags"></i>model</a></li><li><a href=https://owaspsamm.org/tags/nist><i class="fa fa-tags"></i>nist</a></li><li><a href=https://owaspsamm.org/tags/oss><i class="fa fa-tags"></i>oss</a></li><li><a href=https://owaspsamm.org/tags/process><i class="fa fa-tags"></i>process</a></li><li><a href=https://owaspsamm.org/tags/release><i class="fa fa-tags"></i>release</a></li><li><a href=https://owaspsamm.org/tags/roadmap><i class="fa fa-tags"></i>roadmap</a></li><li><a href=https://owaspsamm.org/tags/samm><i class="fa fa-tags"></i>samm</a></li><li><a href=https://owaspsamm.org/tags/scoring><i class="fa fa-tags"></i>scoring</a></li><li><a href=https://owaspsamm.org/tags/services><i class="fa fa-tags"></i>services</a></li><li><a href=https://owaspsamm.org/tags/ssdf><i class="fa fa-tags"></i>ssdf</a></li><li><a href=https://owaspsamm.org/tags/suite><i class="fa fa-tags"></i>suite</a></li><li><a href=https://owaspsamm.org/tags/version-2><i class="fa fa-tags"></i>version-2</a></li><li><a href=https://owaspsamm.org/tags/vulnerabilities><i class="fa fa-tags"></i>vulnerabilities</a></li></ul></div></div></div></div></div></div><footer id=footer><div class=container><div class="col-md-8 col-sm-6"><h4>About us</h4><p>This is an OWASP Project.</br>OWASP is an open community dedicated to enabling organizations to conceive, develop, acquire, operate, and maintain applications that can be trusted. All of the OWASP tools, documents, forums, and chapters are free and open to anyone interested in improving application security.</p><div class=social><a href=https://github.com/owaspsamm target=_blank style=opacity:1><i class="fab fa-2x fa-github"></i></a><a href=https://owasp.slack.com/messages/C0VF1EJGH target=_blank style=opacity:1><i class="fab fa-2x fa-slack"></i></a><a href=https://www.linkedin.com/company/owasp-samm/ target=_blank style=opacity:1><i class="fab fa-2x fa-linkedin-in"></i></a><a href=https://twitter.com/OwaspSAMM target=_blank style=opacity:1><i class="fa-brands fa-2x fa-x-twitter"></i></a><a href=https://www.meetup.com/owasp-samm/ target=_blank style=opacity:1><i class="fab fa-2x fa-meetup"></i></a><a href=https://www.youtube.com/channel/UCEZDbvQrj5APg5cEET49A_g target=_blank style=opacity:1><i class="fa fa-2x fa-youtube"></i></a><a href=mailto:info@owaspsamm.org target=_blank style=opacity:1><i class="fa fa-2x fa-envelope"></i></a></div><hr class="hidden-md hidden-lg hidden-sm"></div><div class="col-md-4 col-sm-6"><a href=https://owasp.org target=_blank><img src=https://owaspsamm.org//img/owasp_logo_1c_w_notext.png alt="Addressing Log4J vulnerabilities with SAMM"></a></div></div></footer><div id=copyright><div class=container><div class=col-md-12><p class=pull-left>OWASP SAMM is published under the
<a href=https://creativecommons.org/licenses/by-sa/4.0/>CC BY-SA 4.0 license</a>
and we share the
<a href=https://owasp.org/www-policy/operational/privacy>OWASP Privacy Policy</a></p><p class=pull-right>Template by <a href=http://bootstrapious.com/free-templates>Bootstrapious</a>.
Ported to Hugo by <a href=https://github.com/devcows/hugo-universal-theme>DevCows</a></p></div></div></div></div><script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-127457120-1','auto'),ga('send','pageview'))</script><script src=//code.jquery.com/jquery-3.1.1.min.js integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin=anonymous></script><script src=//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js integrity=sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa crossorigin=anonymous></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/waypoints/4.0.1/jquery.waypoints.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/Counter-Up/1.0/jquery.counterup.min.js></script><script src=//cdnjs.cloudflare.com/ajax/libs/jquery-parallax/1.1.3/jquery-parallax.js></script><script src="//maps.googleapis.com/maps/api/js?v=3.exp"></script><script src=https://owaspsamm.org/js/hpneo.gmaps.js></script><script src=https://owaspsamm.org/js/gmaps.init.js></script><script src=https://owaspsamm.org/js/front.js></script><script src=https://owaspsamm.org/js/tabs.js></script><script src=https://owaspsamm.org/js/owl.carousel.min.js></script><script src=https://cdn.jsdelivr.net/npm/cookieconsent@3/build/cookieconsent.min.js data-cfasync=false></script><script>window.cookieconsent.initialise({palette:{popup:{background:"#66b8b8"},button:{background:"#366867"}},content:{message:"We use cookies mainly to analyze traffic. Some video providers also use cookies.",href:"https://owasp.org/www-policy/operational/privacy"}})</script><script async src="https://www.googletagmanager.com/gtag/js?id=G-44N5RHDT94"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-44N5RHDT94')</script></body></html>